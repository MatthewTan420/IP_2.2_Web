<!DOCTYPE html>
<html>
<head>
    <title>Page Title</title>
    <link href="style.css" rel="stylesheet" type="text/css" >

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBrcdSOA1oClARGoG6Y3w6GgMAr_Awtduw",
            authDomain: "sungai-buloh.firebaseapp.com",
            databaseURL: "https://sungai-buloh-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "sungai-buloh",
            storageBucket: "sungai-buloh.appspot.com",
            messagingSenderId: "431778937928",
            appId: "1:431778937928:web:161d4237ff3935ac272c7d"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        const db = getDatabase();
        const playerRef = ref(db, "players");

        class userID { 
            static userID = "";
        }

        import {
            getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut
            } from 'https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js';
            const auth = getAuth();
            var frmlogUser = document.getElementById("frmlogUser");
            if (frmlogUser != null){
                frmlogUser.addEventListener("submit", function(e){
                e.preventDefault();
                var email = document.getElementById("email").value;
                var password = document.getElementById("password").value;
                loginUser(email, password);
                console.log("email" + email + "password" + password);
            });
            }

            onAuthStateChanged(auth, (currentUser) => {
                if (currentUser) {
                // User is signed in, see docs for a list of available properties
                // https://firebase.google.com/docs/reference/js/firebase.User
                    const uid = currentUser.uid;
                    console.log(`(OnAuthStateChanged) Current user is logged in:
                ${currentUser.email} :: ${currentUser.uid}`)
                    console.log(userID.userID);
                    userID.userID = currentUser.uid;
                    console.log(userID.userID);
                } else {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.log(`ErrorCode: ${errorCode} -> Message: ${errorMessage}`);
                }
            });

            

        import {
        getDatabase, ref, child, get,set,onValue,push,update,remove
        } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";    

            function loginUser(email, password){
            signInWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
                // Signed in 
                const user = userCredential.user;
                console.log("login");
                window.location.href='photo.html';
            })
                .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                console.log(`ErrorCode: ${errorCode} -> Message: ${errorMessage}`);
            });
        }

      </script>

</head>
<body>

    <div class="container">
        <div class="login-box">
            <h2>Sungei Buloh Nature Reserve</h2>
            <form id="frmlogUser" class="login-form">
                <div class="input-group">
                    <input type="text" id="email" name="email" placeholder="Email">
                </div>
                <div class="input-group">
                    <input type="password" id="password" name="password" placeholder="Password">
                </div>
                <button type="submit" class="btn-login">Login</button>
                <!-- Add any other links or buttons here -->
            </form>
        </div>
    </div>


</body>
</html>